from pont.client import world
from pont.client.world.entities.player import Race, Gender, CombatClass
from pont.client.world.guid import Guid, GuidType

def test_SMSG_LOGIN_VERIFY_WORLD():
	data = bytes.fromhex('00163602010000006B65B7457FB382C544B7CE44A0F84540')
	packet = world.net.packets.SMSG_LOGIN_VERIFY_WORLD.parse(data)
	assert packet.map == 1
	assert packet.position.x == 1653.72705078125
	assert packet.position.y == -4182.43701171875
	assert packet.position.z == 5868.67724609375
	assert packet.rotation == 3.0932998657226562
	print(packet)

def test_SMSG_CLIENTCACHE_VERSION():
	data = bytes.fromhex('0006AB0403000000')
	packet = world.net.packets.SMSG_CLIENTCACHE_VERSION.parse(data)
	assert packet.version == 3
	print(packet)

def test_SMSG_WARDEN_DATA():
	data = bytes.fromhex('0022E6026CA213466EB28B199C9CBBA176D81DB89558D8ABDFBC65D71ABFF97183873601')
	packet = world.net.packets.SMSG_WARDEN_DATA.parse(data)
	print(packet)

def test_SMSG_TUTORIAL_FLAGS():
	data = bytes.fromhex('0022FD00F7BFEFFCE3A3F503000000000000000000000000000000000000000000000000')
	packet = world.net.packets.SMSG_TUTORIAL_FLAGS.parse(data)
	print(packet)

def test_SMSG_ADDON_INFO():
	data = bytes.fromhex('00BEEF020201000000000000020100000000000002010000000000000201000000000000020100000000000002010000000000000201000000000000020100000000000002010000000000000201000000000000020100000000000002010000000000000201000000000000020100000000000002010000000000000201000000000000020100000000000002010000000000000201000000000000020100000000000002010000000000000201000000000000020100000000000000000000')
	packet = world.net.packets.SMSG_ADDON_INFO.parse(data)
	print(packet)

def test_SMSG_CHAR_ENUM():
	data = bytes.fromhex('03423B0003CC72330000000007537465616B6F000607000A04000106011100000001000000AA83B8C477C605C5ABC3BA42000000700000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000004A27000004000000000000000000000000000000000000000000004227000007000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004A14000015000000002A4900000E0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000087EA4A000000000753646764666A676B6A000B0501010507060101C40D0000120200003D9A77C5CDAC59C6E13AC94200000070000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000A609000004000000002A8D00001400000000000000000000000000BC0C00000700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000624800001100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000C2E14E0000000007526F676D6F6F000404010504030507097906000001000000D2211846F0672745E598A44400000070000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000B22600000400000000000000000000000000E32000000600000000374200000700000000BB26000008000000000000000000000000008F1E00000A00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000FA5000001100000000000000000000000000FB9C0000190000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000')
	char_enum = world.net.packets.SMSG_CHAR_ENUM.parse(data)
	print(f'{char_enum}')

	steako = char_enum.characters[0]
	assert steako.guid == Guid(value=0x7000000003372cc)
	assert steako.race == Race.tauren
	assert steako.gender == Gender.male
	assert steako.combat_class == CombatClass.shaman
	assert steako.skin == 10
	assert steako.face == 4
	assert steako.hair_style == 0
	assert steako.hair_color == 1
	assert steako.facial_hair == 6
	assert steako.level == 1
	assert steako.zone == 17
	assert steako.map == 1

	sdgdfjgkj = char_enum.characters[1]
	assert sdgdfjgkj.name == 'Sdgdfjgkj'
	assert sdgdfjgkj.race == Race.draenai
	assert sdgdfjgkj.combat_class == CombatClass.priest
	assert sdgdfjgkj.gender == Gender.female
	assert sdgdfjgkj.skin == 1
	assert sdgdfjgkj.face == 5
	assert sdgdfjgkj.hair_style == 7
	assert sdgdfjgkj.hair_color == 6
	assert sdgdfjgkj.level == 1
	assert sdgdfjgkj.zone == 3524
	assert sdgdfjgkj.map == 530
	assert sdgdfjgkj.position.x == 100.61499786376953
	assert sdgdfjgkj.position.y == -13931.2001953125
	assert sdgdfjgkj.position.z == -3961.639892578125

	rogmoo = char_enum.characters[2]
	assert rogmoo.name == 'Rogmoo'
	assert rogmoo.race == Race.night_elf
	assert rogmoo.combat_class == CombatClass.rogue
	assert rogmoo.gender == Gender.female
	assert rogmoo.skin == 5
	assert rogmoo.face == 4
	assert rogmoo.hair_style == 3
	assert rogmoo.hair_color == 5
	assert rogmoo.facial_hair == 7
	assert rogmoo.level == 9
	assert rogmoo.zone == 1657
	assert rogmoo.map == 1

def test_SMSG_CHAR_ENUM2():
	data = bytes.fromhex('01143B00010100000000000000416374000109010202080902506A020000010000006B65B7457FB382C544B7CE4401000000000000020000000000000000000000000000000000209E00000100000000000000000000000000EC9E00000300000000A81E00000400000000229E000014000000000000000000000000007601000007000000001256000008000000000000000000000000001F9E00000A000000000000000000000000000000000000000000000000000000000000000000000000000000007BF000001000000000000000000000000000000000000000000000000000000000000000000000000000000000B82C00001200000000000000000000000000000000000000000000000000000000000000')
	char_enum = world.net.packets.SMSG_CHAR_ENUM.parse(data)
	print(f'{char_enum}')

	act = char_enum.characters[0]
	assert act.name == 'Act'
	assert act.race == Race.human
	assert act.combat_class == CombatClass.warlock
	assert act.gender == Gender.female
	assert act.skin == 2
	assert act.face == 2
	assert act.hair_style == 8
	assert act.hair_color == 9
	assert act.facial_hair == 2
	assert act.level == 80
	assert act.zone == 618
	assert act.map == 1

def test_CMSG_CHAR_ENUM():
	data = bytes.fromhex('000437000000')
	char_enum_request = world.net.packets.CMSG_CHAR_ENUM.parse(data)
	print(f'{char_enum_request}')

def test_CMSG_PLAYER_LOGIN():
	data = bytes.fromhex('000C3D0000000100000000000000')
	packet = world.net.packets.CMSG_PLAYER_LOGIN.parse(data)
	assert packet.player_guid == Guid(counter=1, type=GuidType.player)
	print(packet)

def test_CMSG_GUILD_QUERY():
	data = bytes.fromhex('00065400000001000000')
	packet = world.net.packets.CMSG_GUILD_QUERY.parse(data)
	assert packet.guild_id == 1
	print(packet)

def test_SMSG_GUILD_QUERY_RESPONSE():
	data = bytes.fromhex('00635500010000004361727065204B696E64657267617274656E004775696C64204D6173746572004F666669636572005665746572616E004D656D62657200496E697469617465000000000000000000000000000000000000000000000000000005000000')
	packet = world.net.packets.SMSG_GUILD_QUERY_RESPONSE.parse(data)
	print(packet)

def test_SMSG_GUILD_ROSTER():
	data = bytes.fromhex('03BE8A001400000068656C6C6F206272617465000005000000FFF11D00FFFFFFFF000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000FFF11D000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000043000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000430000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005000000000000000041646964690004000000FF0200210000005054A3410000130000000000000000466C6F72796E656C0004000000C80200210000002A0BB541000001000000000000000141637400000000005009006A0200000000120000000000000000466C79650004000000C8090021000000B8D9B44100000C00000000000000005368656C6C0004000000C808002100000051196941000016000000000000000052656473706F74646F776E0004000000FF0200210000008635AB4100000B0000000000000000456C696D696E650004000000FF02002100000092BAB34100001C0000000000000000436C65700004000000FF040021000000EE749B410000140000000000000000477269640004000000FF010021000000850BB44100001500000000000000004C796C6C610004000000CE02002100000022629C4100000700000000000000004C75636B790001000000CB01002100000008F49341000018000000000000000052656E64657A0004000000510500210000000070B1410000170000000000000000506F726E6875620004000000FF010021000000CC8DB34100000D00000000000000004B69640004000000C8010021000000073AAC4100000E0000000000000000476E6F6D65736F6D650004000000CA040021000000780CB5410000190000000000000000436C657069630004000000FF0100EF050000F002AC4100000F00000000000000004D616C660004000000C8040021000000B0D03D4100001B000000000000000050657273697374656E63650004000000FF0500210000000FD8AB4100001000000000000000004761696C69730004000000FF0400210000007BE9A24100001100000000000000004B617468656C0004000000FF010021000000C3FAAB410000')
	packet = world.net.packets.SMSG_GUILD_ROSTER.parse(data)
	print(packet)

	data2 = bytes.fromhex('03D88A001500000068656C6C6F206272617465000005000000FFF11D00FFFFFFFF000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000FFF11D00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000430000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000043000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001F000000000000000145636F0001000000500400EF050000000018000000000000000052656E64657A000400000051050021000000DFFCC94100000D00000000000000004B69640004000000C8010021000000E6C6C4410000170000000000000000506F726E6875620004000000FF010021000000AB1ACC4100000C00000000000000005368656C6C0004000000C808002100000087198D4100001000000000000000004761696C69730004000000FF0400210000005A76BB4100001B000000000000000050657273697374656E63650004000000FF050021000000EE64C44100000F00000000000000004D616C660004000000C80400210000006EEA6E4100001C0000000000000000436C65700004000000FF040021000000CD01B44100000B0000000000000000456C696D696E650004000000FF0200210000007147CC4100000E0000000000000000476E6F6D65736F6D650004000000CA0400210000005799CD410000190000000000000000436C657069630004000000FF0100EF050000CF8FC44100001100000000000000004B617468656C0004000000FF010021000000A287C4410000120000000000000000466C79650004000000C80900210000009766CD4100000100000000000000014163740000000000500900EF0500000000130000000000000000466C6F72796E656C0004000000C80200210000000998CD41000005000000000000000041646964690004000000FF0200210000002FE1BB41000016000000000000000052656473706F74646F776E0004000000FF02002100000065C2C3410000140000000000000000477269640004000000FF0100210000006498CC4100000700000000000000004C75636B790001000000CB010021000000E780AC4100001500000000000000004C796C6C610004000000CE02002100000001EFB4410000')
	packet2 = world.net.packets.SMSG_GUILD_ROSTER.parse(data)
	print(packet2)

def test_SMSG_GUILD_EVENT():
	data = bytes.fromhex('000B9200020161797979797900')
	packet = world.net.packets.SMSG_GUILD_EVENT.parse(data)
	print(packet)

# def test_SMSG_TIME_SYNC_REQ():
# 	data = bytes.fromhex('0006900305000000')
# 	packet = world.net.packets.SMSG_TIME_SYNC_REQ.parse(data)
# 	print(packet)
#
# 	data2 = bytes.fromhex('000690033E010000')
# 	packet2 = world.net.packets.CMSG_TIME_SYNC_RES.parse(data)
# 	print(packet2)
#
# def test_CMSG_TIME_SYNC_REQ():
# 	data = bytes.fromhex('000A910305000000D5C30000')
# 	packet = world.net.packets.CMSG_TIME_SYNC_RES.parse(data)
# 	print(packet)

def test_CMSG_NAME_QUERY():
	data = bytes.fromhex('000C500000001F00000000000000')
	packet = world.net.packets.CMSG_NAME_QUERY.parse(data)
	assert packet.guid == Guid(counter=0x1f)
	print(packet)

def test_SMSG_NAME_QUERY():
	data = bytes.fromhex('000E5100011F0045636F000001010400')
	packet = world.net.packets.SMSG_NAME_QUERY_RESPONSE.parse(data)
	print(packet)